<html>
  <head>
  </head>
  <body>
    <div>
      <span id="dbContainer">-</span> db
    </div>

    <div id="actionContainer">
      <a href="#" id="btnStartMonitoring">Start monitoring</a>
      <a href="#" id="btnStopMonitoring">Stop monitoring</a>
    </div>

    <script src="decibelMonitor.js"></script>
    <script>
      
    let interval = null;
    let dbMonnitor = null;

    async function startMonitoring(e) {
      e.preventDefault();

      if(!dbMonitor){
        dbMonitor = new DecibelMonitor();
      }

      if(interval){
        return;
      }
      
      await dbMonitor.connectMic();

      interval = setInterval(function() {
        let vol = dbMonitor.getVolume();
        document.getElementById('dbContainer').innerHTML = vol;
        console.log(vol);
      }, 1000);
    }

    function stopMonitoring(e) {
      e.preventDefault();

      clearInterval(interval);
      dbMonitor.disconnectMic();

      document.getElementById('dbContainer').innerHTML = '-';
    }

    document.getElementById('btnStartMonitoring').addEventListener('click', startMonitoring);
    document.getElementById('btnStopMonitoring').addEventListener('click', stopMonitoring);

    </script>
</body>

